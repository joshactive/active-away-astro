---
// 404 Error Page - Beautiful, on-brand design
import BaseLayout from '../layouts/BaseLayout.astro';
import { getResponsiveImageAttrs } from '../utils/cloudflareImages.js';

// Background image - Use a high-quality tennis/sports court image
// Using a 16:9 aspect ratio for hero-style background
const BACKGROUND_WIDTH = 1920;
const BACKGROUND_HEIGHT = 1080;

// Use Cloudflare Images for the background
// This ID should be replaced with an actual tennis/padel/pickleball court image from your Cloudflare account
const backgroundAttrs = getResponsiveImageAttrs('03bade93-3cf6-49b0-047f-a9eb556aa200', {
  displayWidth: BACKGROUND_WIDTH,
  displayHeight: BACKGROUND_HEIGHT,
  fit: 'cover',
  alt: '404 - Page Not Found',
  sizes: '100vw',
  quality: 60
});

// SEO Meta
const pageTitle = '404 - Page Not Found | Active Away';
const pageDescription = "Oops! The page you're looking for doesn't exist. Explore our tennis, padel, and pickleball holidays instead.";

// Capture the requested URL for analytics
const requestedPath = Astro.url.pathname;
const referrer = Astro.request.headers.get('referer') || 'Direct';
---

<BaseLayout 
  title={pageTitle}
  description={pageDescription}
>
  <!-- Full-screen 404 Section -->
  <section class="relative w-full h-screen flex items-center justify-center overflow-hidden">
    <!-- Background Image with Overlay -->
    <div class="absolute inset-0 w-full h-full">
      <img 
        src={backgroundAttrs.src}
        srcset={backgroundAttrs.srcset}
        sizes={backgroundAttrs.sizes}
        alt={backgroundAttrs.alt}
        width={backgroundAttrs.width || BACKGROUND_WIDTH}
        height={backgroundAttrs.height || BACKGROUND_HEIGHT}
        class="w-full h-full object-cover object-center"
        loading="eager"
        fetchpriority="high"
      />
      <!-- Dark overlay gradient for text readability -->
      <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/50 to-black/60"></div>
    </div>

    <!-- Content Container -->
    <div class="relative z-10 container mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <div class="max-w-3xl mx-auto flex flex-col items-center gap-6 sm:gap-8">
        
        <!-- Page Not Found Heading -->
        <h1 class="font-playfair font-semibold text-3xl sm:text-4xl lg:text-5xl text-white leading-tight">
          Page Not Found
        </h1>

        <!-- Helpful Message -->
        <p class="font-inter text-base sm:text-lg lg:text-xl text-white/90 leading-relaxed max-w-2xl">
          We couldn't find the page you're looking for. It might have been moved, deleted, or perhaps the URL was mistyped.
        </p>

        <!-- CTA Buttons -->
        <div class="flex flex-col sm:flex-row items-center gap-4 mt-4 sm:mt-6">
          <!-- Primary CTA - Return Home -->
          <a 
            href="/"
            class="inline-flex items-center justify-center bg-[#ad986c] hover:bg-[#8d7a56] text-white font-inter font-semibold px-8 py-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl hover:scale-105 text-base sm:text-lg"
          >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
            </svg>
            Return Home
          </a>

          <!-- Secondary CTA - Browse Events -->
          <a 
            href="/events"
            class="inline-flex items-center justify-center bg-white/20 hover:bg-white/30 backdrop-blur-md border border-white/40 text-white font-inter font-semibold px-8 py-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl text-base sm:text-lg"
          >
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            Browse Events
          </a>
        </div>

      </div>
    </div>
  </section>

  <!-- 404 Error Tracking -->
  <script define:vars={{ requestedPath, referrer }}>
    // Track 404 errors in Google Analytics (if available)
    if (typeof gtag !== 'undefined') {
      gtag('event', 'exception', {
        description: `404 Error: ${requestedPath}`,
        fatal: false,
        page_path: requestedPath,
        page_referrer: referrer
      });
      
      gtag('event', 'page_not_found', {
        page_path: requestedPath,
        referrer: referrer
      });
    }

    // Also send to Google Tag Manager dataLayer (if available)
    if (typeof window !== 'undefined' && window.dataLayer) {
      window.dataLayer.push({
        event: '404_error',
        page_path: requestedPath,
        referrer: referrer,
        error_type: 'page_not_found'
      });
    }

    // Console log for debugging (can be removed in production)
    console.log('ðŸš« 404 Error:', {
      path: requestedPath,
      referrer: referrer,
      timestamp: new Date().toISOString()
    });
  </script>
</BaseLayout>

<style>
  /* Ensure proper font rendering */
  .font-inter {
    font-family: 'Inter', 'Inter Fallback', -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
  }
  
  .font-playfair {
    font-family: 'Playfair Display', 'Playfair Fallback', Georgia, serif;
  }

  /* Smooth animations */
  a {
    transition: all 0.3s ease;
  }
</style>

