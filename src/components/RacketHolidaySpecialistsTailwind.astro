---
// Racket Holiday Specialists section component for Active Away - Tailwind CSS Version
import { getImageByName, getResponsiveImageByName, getStrapiImageAttrs } from '../utils/cloudflareImages.js';

// Accept homeData as prop (fetched once in index.astro)
interface Props {
  homeData?: any;
}

const { homeData } = Astro.props;

const specialistData = {
  title: homeData?.racketSpecialist?.title || "Racket Holiday Specialists",
  description: homeData?.racketSpecialist?.description || "Racket sports are at the heart of what we do, and we're excited to share that passion with you. As trailblazers in Adult & Family Tennis Holidays, Padel Holidays, and Pickleball Holidays, we hold ourselves to the highest standards. Experience our signature hosting style, where our dedicated team goes above and beyond to make every moment exceptional.",
  bulletPoints: homeData?.racketSpecialist?.bulletPoints?.length > 0 ? homeData.racketSpecialist.bulletPoints.slice(0, 4) : Array(4).fill("Lorem Ipsum"),
  buttonText: homeData?.racketSpecialist?.buttonText || "Learn More",
  quote: homeData?.racketSpecialist?.quote || "The best tennis holiday we've ever experienced. The coaching was world-class and the location was absolutely stunning!",
  quoteAuthor: homeData?.racketSpecialist?.quoteAuthor || "Sarah & Mark Thompson"
};

const RACKET_BG_SIZES = '(max-width: 1024px) 100vw, 50vw';

const buildRacketBackground = (imageName, alt) => {
  const attrs = getResponsiveImageByName(imageName, {
    displayWidth: 1200,
    displayHeight: 800,
    fit: 'cover',
    alt,
    sizes: RACKET_BG_SIZES
  });

  if (attrs) {
    return attrs;
  }

  const fallbackSrc = getImageByName(imageName, { width: 1200, height: 800, fit: 'cover', format: 'auto', quality: 85 });
  return {
    src: fallbackSrc,
    url: fallbackSrc,
    width: 1200,
    height: 800,
    alt,
    loading: 'lazy',
    sizes: RACKET_BG_SIZES
  };
};

const racketSpecialistBg = homeData?.racketSpecialist?.images?.bg
  ? getStrapiImageAttrs(homeData.racketSpecialist.images.bg, {
      displayWidth: 1200,
      displayHeight: 800,
      fit: 'cover',
      alt: homeData.racketSpecialist.images.bg.alt || 'Racket sports resort',
      sizes: RACKET_BG_SIZES
    })
  : buildRacketBackground('racket-specialist-bg', 'Racket sports resort');

// Debug: Log the URL being generated
console.log('Racket Specialist Background URL:', racketSpecialistBg?.url || racketSpecialistBg?.src);
---

<section class="w-full bg-white pt-6 sm:pt-8 lg:pt-12 pb-12 sm:pb-16 lg:pb-24">
  <div class="container mx-auto px-4 sm:px-10">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 lg:gap-12 lg:items-stretch">
      <!-- Content Column -->
      <div class="lg:order-1 h-full flex flex-col justify-center">
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-playfair font-semibold text-gray-900 mb-6 sm:mb-8">
          {specialistData.title}
        </h2>
        
        <p class="text-base sm:text-lg font-inter text-gray-800 leading-relaxed mb-8 sm:mb-10">
          {specialistData.description}
        </p>
        
        <!-- Bullet Points Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-8 sm:mb-10">
          <!-- Left Column -->
          <div class="space-y-3 sm:space-y-4">
            {specialistData.bulletPoints.slice(0, 2).map((point) => (
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-gold rounded-full flex-shrink-0"></div>
                <span class="text-sm sm:text-base font-inter text-gray-700">{point}</span>
              </div>
            ))}
          </div>
          
          <!-- Right Column -->
          <div class="space-y-3 sm:space-y-4">
            {specialistData.bulletPoints.slice(2, 4).map((point) => (
              <div class="flex items-center gap-3">
                <div class="w-2 h-2 bg-gold rounded-full flex-shrink-0"></div>
                <span class="text-sm sm:text-base font-inter text-gray-700">{point}</span>
              </div>
            ))}
          </div>
        </div>
        
        <!-- CTA Button -->
        <div class="w-fit">
          <button class="inline-flex items-center gap-3 bg-gray-900 hover:bg-gray-800 text-white px-6 sm:px-8 py-3 sm:py-4 rounded-full font-inter font-medium text-sm sm:text-base transition-all duration-300 hover:-translate-y-0.5">
            <span>{specialistData.buttonText}</span>
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none">
              <path d="M7 17L17 7M17 7H7M17 7V17" stroke="#FFFFFF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      </div>
      
      <!-- Image Column -->
      <div class="lg:order-2 h-full min-h-[400px] sm:min-h-[500px] lg:min-h-[600px]">
        <div class="relative overflow-hidden h-full w-full rounded-[48px]">
          <img 
            src={racketSpecialistBg.src || racketSpecialistBg.url} 
            {...(racketSpecialistBg.srcset && { srcset: racketSpecialistBg.srcset })}
            sizes={racketSpecialistBg.sizes || RACKET_BG_SIZES}
            width={racketSpecialistBg.width || 1200}
            height={racketSpecialistBg.height || 800}
            alt={racketSpecialistBg.alt || 'Racket Holiday Resort'}
            loading={racketSpecialistBg.loading || 'lazy'}
            class="w-full h-full object-cover"
          />
          
          <!-- Testimonial Quote Card -->
          <div class="absolute bottom-6 sm:bottom-8 lg:bottom-10 right-6 sm:right-8 lg:right-10 bg-white/95 backdrop-blur-sm rounded-2xl p-5 sm:p-6 lg:p-8 shadow-2xl w-[calc(100%-3rem)] sm:w-[380px] lg:w-[420px]">
            <div class="relative">
              <!-- Opening Quote Mark -->
              <svg class="w-8 h-8 sm:w-10 sm:h-10 text-gold/30 absolute -top-2 -left-1" width="40" height="40" viewBox="0 0 24 24" fill="currentColor">
                <path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/>
              </svg>
              
              <!-- Quote Text -->
              <blockquote class="relative pt-2">
                <p class="text-sm sm:text-base lg:text-lg font-inter text-gray-900 leading-relaxed mb-3 sm:mb-4 italic">
                  {specialistData.quote}
                </p>
                
                <!-- Author -->
                <footer class="flex items-center gap-2 mt-4">
                  <div class="h-px flex-1 bg-gold/30 min-w-[40px]"></div>
                  <cite class="text-xs sm:text-sm font-inter font-semibold text-gold not-italic whitespace-nowrap">
                    {specialistData.quoteAuthor}
                  </cite>
                </footer>
              </blockquote>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .font-inter {
    font-family: 'Inter', sans-serif;
  }
  
  .font-playfair {
    font-family: 'Playfair Display', serif;
  }
  
</style>
