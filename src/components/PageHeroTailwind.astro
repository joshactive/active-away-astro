---
// Page Hero component - Standard hero with background, breadcrumbs, and heading
import { getStrapiImageAttrs } from '../utils/cloudflareImages.js';

interface Props {
  pageData?: any;
  breadcrumbs?: Array<{label: string, href?: string}>;
}

const { pageData, breadcrumbs } = Astro.props;

const heroData = {
  kicker: pageData?.pageHero?.kicker || '',
  heading: pageData?.pageHero?.heading || 'Page Title',
  subtitle: pageData?.pageHero?.subtitle || '',
  backgroundImage: pageData?.pageHero?.backgroundImage || null,
  showBreadcrumbs: pageData?.pageHero?.showBreadcrumbs !== false
};

// Process background image
let backgroundImageAttrs = null;
if (heroData.backgroundImage) {
  const imageUrl = heroData.backgroundImage.url || heroData.backgroundImage;
  const imageAlt = heroData.backgroundImage.alt || heroData.backgroundImage.alternativeText || heroData.heading;
  
  if (typeof imageUrl === 'string') {
    backgroundImageAttrs = getStrapiImageAttrs(
      { url: imageUrl, alt: imageAlt },
      {
        displayWidth: 1920,
        displayHeight: 600,
        fit: 'cover',
        sizes: '100vw',
        quality: 75
      }
    );
    
    if (!backgroundImageAttrs) {
      backgroundImageAttrs = {
        src: imageUrl,
        url: imageUrl,
        alt: imageAlt,
        loading: 'eager'
      };
    }
  }
}

// Default breadcrumbs if not provided
const defaultBreadcrumbs = breadcrumbs || [
  { label: 'Home', href: '/' },
  { label: heroData.heading }
];
---

<section class="relative w-full h-[400px] sm:h-[500px] lg:h-[600px] overflow-hidden">
  <!-- Background Image -->
  {backgroundImageAttrs && (
    <img 
      src={backgroundImageAttrs.src || backgroundImageAttrs.url}
      {...(backgroundImageAttrs.srcset && { srcset: backgroundImageAttrs.srcset })}
      {...(backgroundImageAttrs.sizes && { sizes: backgroundImageAttrs.sizes })}
      alt={backgroundImageAttrs.alt || heroData.heading}
      width={backgroundImageAttrs.width || 1920}
      height={backgroundImageAttrs.height || 600}
      class="absolute inset-0 w-full h-full object-cover"
      fetchpriority="high"
      decoding="async"
    />
  )}
  
  <!-- Gradient Overlay -->
  <div class="absolute inset-0 bg-gradient-to-b from-[#0D1C4E]/80 via-[#0D1C4E]/70 to-[#0D1C4E]/65 z-10"></div>
  
  <!-- Content -->
  <div class="relative z-20 container mx-auto max-w-[1400px] px-4 sm:px-10 h-full flex flex-col justify-center items-center text-center">
    
    <!-- Kicker -->
    {heroData.kicker && (
      <div class="hidden sm:block text-xs sm:text-sm font-inter font-semibold text-gold tracking-[0.2em] uppercase mb-4 sm:mb-6 border-t border-b border-gold/50 py-2 px-6">
        {heroData.kicker}
      </div>
    )}
    
    <!-- Heading -->
    <h1 class="text-4xl sm:text-5xl lg:text-7xl font-playfair font-bold text-white mb-6 sm:mb-8 leading-tight max-w-4xl">
      {heroData.heading}
    </h1>
    
    <!-- Subtitle -->
    {heroData.subtitle && (
      <p class="text-lg sm:text-xl lg:text-2xl font-inter text-white max-w-3xl leading-relaxed">
        {heroData.subtitle}
      </p>
    )}
  </div>
</section>

<style>
  .font-inter {
    font-family: 'Inter', sans-serif;
  }
  
  .font-playfair {
    font-family: 'Playfair Display', serif;
  }
</style>

