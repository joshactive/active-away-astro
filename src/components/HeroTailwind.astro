---
// Hero section component for Active Away - Figma Perfect Match
import { getImageByName, getStrapiImageAttrs, getResponsiveImageAttrs } from '../utils/cloudflareImages.js';
import { fetchAPI } from '../utils/strapi.js';

// Accept homeData as prop (fetched once in index.astro)
interface Props {
  homeData?: any;
}

const { homeData } = Astro.props;

// Extract heading and subheading with fallbacks
const mainHeading = homeData?.hero?.heading || 'Exceptional Tennis, Padel & Pickleball Holidays';
const mainSubHeading = homeData?.hero?.subHeading || 'Unique Racket Experiences that unite like-minded individuals, through impeccable service delivered by truly knowledgeable hosts in excellent locations.';

// ==========================================
// Fetch Events Data for Search Dropdowns
// ==========================================
let eventsSearchData = {
  products: [],
  venues: [],
  months: [],
  allEvents: []
};

try {
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  const todayISO = today.toISOString().split('T')[0];
  
  // Fetch all future events (paginated to handle >100 events)
  let allEventsRaw = [];
  let page = 1;
  let hasMore = true;
  
  while (hasMore) {
    const data = await fetchAPI(`/events?filters[dateFrom][$gte]=${todayISO}&populate=*&sort=dateFrom:asc&pagination[page]=${page}&pagination[pageSize]=100`);
    
    if (data && data.data && data.data.length > 0) {
      allEventsRaw = [...allEventsRaw, ...data.data];
      page++;
      
      // If we got less than 100, we've reached the end
      if (data.data.length < 100) {
        hasMore = false;
      }
    } else {
      hasMore = false;
    }
  }
  
  console.log(`üîç [HeroTailwind] Fetched ${allEventsRaw.length} future events for search dropdowns`);
  
  if (allEventsRaw.length > 0) {
    // Map events to simple structure with needed fields (handle both Strapi 4 and 5 structures)
    const events = allEventsRaw.map(item => {
      const event = item.attributes || item;
      return {
        product: event.product || '',
        venue_plain_text: event.venue_plain_text || '',
        dateFrom: event.dateFrom || ''
      };
    });
    
    // Extract unique products
    const products = [...new Set(events.map(e => e.product).filter(Boolean))].sort();
    
    // Extract unique venues (from venue_plain_text)
    const venues = [...new Set(events.map(e => e.venue_plain_text).filter(Boolean))].sort();
    
    // Extract unique months from dateFrom
    const monthsSet = new Set();
    events.forEach(e => {
      if (e.dateFrom) {
        const date = new Date(e.dateFrom);
        const monthName = date.toLocaleDateString('en-US', { month: 'long' });
        monthsSet.add(monthName);
      }
    });
    const months = Array.from(monthsSet).sort((a, b) => {
      const monthOrder = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      return monthOrder.indexOf(a) - monthOrder.indexOf(b);
    });
    
    eventsSearchData = {
      products,
      venues,
      months,
      allEvents: events
    };
    
    console.log(`üìä [HeroTailwind] Products: ${products.length}, Venues: ${venues.length}, Months: ${months.length}`);
  }
} catch (error) {
  console.error('‚ùå [HeroTailwind] Error fetching events for search:', error);
}

// ==========================================
// Hero Background Image - Dynamic from Strapi
// ==========================================
// Design dimensions: 16:9 aspect ratio for hero background
const HERO_DESIGN_WIDTH = 1920;
const HERO_DESIGN_HEIGHT = 1080;

let heroBgAttrs;

// Check if Strapi has a headerImage
if (homeData?.hero?.headerImage) {
  const strapiHeroBg = homeData.hero.headerImage;
  
  if (strapiHeroBg.url) {
    heroBgAttrs = getStrapiImageAttrs(strapiHeroBg, {
      displayWidth: HERO_DESIGN_WIDTH,
      displayHeight: HERO_DESIGN_HEIGHT,
      fit: 'cover',
      alt: strapiHeroBg.alt || 'Hero background',
      sizes: '100vw',
      quality: 60
    });
    console.log('‚úÖ Using Strapi image with responsive transforms');
  } else {
    console.log('‚ö†Ô∏è  headerImage exists but no URL');
  }
} else {
  console.log('‚ÑπÔ∏è  No headerImage field found in Strapi');
}

// Fallback to hardcoded image
if (!heroBgAttrs) {
  heroBgAttrs = {
    ...getResponsiveImageAttrs('03bade93-3cf6-49b0-047f-a9eb556aa200', {
      displayWidth: HERO_DESIGN_WIDTH,
      displayHeight: HERO_DESIGN_HEIGHT,
      fit: 'cover',
      alt: 'Active Away - Tennis, Padel & Pickleball Holidays',
      sizes: '100vw',
      quality: 60
    }),
  };
  console.log('‚ÑπÔ∏è  Using fallback hero background');
}

heroBgAttrs = {
  ...heroBgAttrs,
  sizes: '100vw',
  loading: 'eager',
  fetchpriority: 'high'
};

// ==========================================
// Other Images
// ==========================================
// Man images - Use Strapi testimonial images with fallback and optimize for small display size
const testimonial1 = homeData?.hero?.testimonialImages?.[0];
const testimonial2 = homeData?.hero?.testimonialImages?.[1];
const testimonial3 = homeData?.hero?.testimonialImages?.[2];
const testimonial4 = homeData?.hero?.testimonialImages?.[3];

const TESTIMONIAL_IMAGE_CONFIG = {
  displayWidth: 96,
  displayHeight: 96,
  fit: 'cover',
  quality: 60,
};

const buildTestimonialImage = (image, fallbackId) => {
  const alt = image?.alt || 'Happy customer review';

  if (image) {
    return getStrapiImageAttrs(image, {
      ...TESTIMONIAL_IMAGE_CONFIG,
      alt,
    });
  }

  return getResponsiveImageAttrs(fallbackId, {
    ...TESTIMONIAL_IMAGE_CONFIG,
    alt,
  });
};

const man1 = buildTestimonialImage(testimonial1, 'man-1');
const man2 = buildTestimonialImage(testimonial2, 'man-2');
const man3 = buildTestimonialImage(testimonial3, 'man-3');
const man4 = buildTestimonialImage(testimonial4, 'man-4');

// Debug: Confirm setup
console.log('üéØ Hero Background:', heroBgAttrs?.src ? 'Ready' : 'Missing');
console.log('üìê Design Dimensions:', `${HERO_DESIGN_WIDTH}x${HERO_DESIGN_HEIGHT}`);
---

<section class="relative w-full h-screen flex flex-col items-start p-0 overflow-x-hidden py-6 sm:py-10">
  <!-- Background Image -->
  <div class="absolute inset-0 w-full h-full">
    <img 
      src={heroBgAttrs.src}
      srcset={heroBgAttrs.srcset}
      sizes={heroBgAttrs.sizes}
      alt={heroBgAttrs.alt}
      width={heroBgAttrs.width || HERO_DESIGN_WIDTH}
      height={heroBgAttrs.height || HERO_DESIGN_HEIGHT}
      class="w-full h-full object-cover object-[30%_center] sm:object-center"
      loading={heroBgAttrs.loading}
      fetchpriority={heroBgAttrs.fetchpriority}
    />
    <div class="absolute inset-0 bg-gradient-to-b from-black/35 to-black/35"></div>
  </div>

  <!-- Main Hero Content -->
  <div class="absolute top-1/2 lg:top-[51%] left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full z-10 flex justify-center items-center">
    <div class="container mx-auto px-4 lg:px-8">
      <div class="w-full flex flex-col items-center justify-center gap-6 sm:gap-8 lg:gap-10 text-center">
        <!-- Headline Section -->
        <div class="flex flex-col items-center justify-center text-center w-full max-w-4xl gap-3 sm:gap-4 md:gap-5">
          <h1 class="w-full font-playfair font-bold text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl leading-tight lg:leading-[1.3] text-center text-white m-0 break-words" style="line-height: 1.3 !important; hyphens: none; -webkit-hyphens: none; -ms-hyphens: none;">
            {mainHeading}
          </h1>
          <p class="w-full font-inter font-normal text-base sm:text-lg md:text-xl lg:text-xl leading-relaxed text-center text-white m-0 max-w-2xl break-words">
            {mainSubHeading}
          </p>
        </div>

        <!-- Search Section -->
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 w-full max-w-2xl sm:max-w-3xl lg:max-w-4xl px-4 sm:px-0">
          <div class="flex flex-col sm:flex-row items-center w-full bg-white/10 backdrop-blur-md border border-white/20 rounded-2xl sm:rounded-full px-3 sm:px-4 md:px-6 py-3 sm:py-3 md:py-4 gap-2 sm:gap-0">
            <!-- Mobile: 2x2 Grid for dropdowns -->
            <div class="grid grid-cols-2 gap-2 w-full sm:hidden">
              <!-- Product Section -->
              <div class="flex flex-row items-center relative">
                <label class="sr-only" for="hero-product-mobile">Product</label>
                <select id="hero-product-mobile" class="w-full h-11 font-inter font-normal text-sm leading-7 flex items-center text-white bg-white/10 border border-white/30 outline-none appearance-none pr-7 cursor-pointer px-3 rounded-lg backdrop-blur-sm">
                  <option value="" class="text-gray-800 bg-white px-4">Product</option>
                  {eventsSearchData.products.map(product => (
                    <option value={product} class="text-gray-800 bg-white px-4">{product}</option>
                  ))}
                </select>
                <svg class="absolute right-2.5 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                </svg>
              </div>
              
              <!-- Location Section -->
              <div class="flex flex-row items-center relative">
                <label class="sr-only" for="hero-location-mobile">Location</label>
                <select id="hero-location-mobile" disabled class="w-full h-11 font-inter font-normal text-sm leading-7 flex items-center text-white bg-white/10 border border-white/30 outline-none appearance-none pr-7 cursor-pointer px-3 rounded-lg backdrop-blur-sm disabled:opacity-50 disabled:cursor-not-allowed">
                  <option value="" class="text-gray-800 bg-white px-4">Location</option>
                </select>
                <svg class="absolute right-2.5 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                </svg>
              </div>
              
              <!-- Month Section -->
              <div class="flex flex-row items-center relative">
                <label class="sr-only" for="hero-month-mobile">Month</label>
                <select id="hero-month-mobile" disabled class="w-full h-11 font-inter font-normal text-sm leading-7 flex items-center text-white bg-white/10 border border-white/30 outline-none appearance-none pr-7 cursor-pointer px-3 rounded-lg backdrop-blur-sm disabled:opacity-50 disabled:cursor-not-allowed">
                  <option value="" class="text-gray-800 bg-white px-4">Month</option>
                </select>
                <svg class="absolute right-2.5 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                </svg>
              </div>
              
              <!-- Search Button (mobile) -->
              <button id="hero-search-mobile" class="inline-flex items-center justify-center bg-white/30 backdrop-blur-md border border-white/30 hover:bg-white/40 active:bg-white/50 rounded-lg px-4 py-2.5 h-11 text-white text-sm transition-all shadow-lg font-medium">
                <svg class="w-4 h-4 mr-1.5" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                  <path d="m21 21-4.34-4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                </svg>
                Search
              </button>
            </div>

            <!-- Desktop: Horizontal layout (unchanged) -->
            <!-- Product Section -->
            <div class="hidden sm:flex flex-row items-center flex-1 min-w-0 relative">
              <label class="sr-only" for="hero-product-desktop">Product</label>
              <select id="hero-product-desktop" class="w-full h-8 md:h-10 font-inter font-normal text-sm md:text-base lg:text-lg leading-7 flex items-center text-white bg-transparent outline-none appearance-none pr-8 cursor-pointer px-4">
                <option value="" class="text-gray-800 bg-white px-4">Select Product</option>
                {eventsSearchData.products.map(product => (
                  <option value={product} class="text-gray-800 bg-white px-4">{product}</option>
                ))}
              </select>
              <svg class="absolute right-2 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
              </svg>
            </div>
            
            <div class="hidden sm:block w-px h-10 bg-white/30 mx-4"></div>
            
            <!-- Location Section -->
            <div class="hidden sm:flex flex-row items-center flex-1 min-w-0 relative">
              <label class="sr-only" for="hero-location-desktop">Location</label>
              <select id="hero-location-desktop" disabled class="w-full h-8 md:h-10 font-inter font-normal text-sm md:text-base lg:text-lg leading-7 flex items-center text-white bg-transparent outline-none appearance-none pr-8 cursor-pointer px-4 disabled:opacity-50 disabled:cursor-not-allowed">
                <option value="" class="text-gray-800 bg-white px-4">Select Location</option>
              </select>
              <svg class="absolute right-2 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
              </svg>
            </div>
            
            <div class="hidden sm:block w-px h-10 bg-white/30 mx-4"></div>
            
            <!-- Month Section -->
            <div class="hidden sm:flex flex-row items-center flex-1 min-w-0 relative">
              <label class="sr-only" for="hero-month-desktop">Month</label>
              <select id="hero-month-desktop" disabled class="w-full h-8 md:h-10 font-inter font-normal text-sm md:text-base lg:text-lg leading-7 flex items-center text-white bg-transparent outline-none appearance-none pr-8 cursor-pointer px-4 disabled:opacity-50 disabled:cursor-not-allowed">
                <option value="" class="text-gray-800 bg-white px-4">Select Month</option>
              </select>
              <svg class="absolute right-2 w-4 h-4 text-white pointer-events-none" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <path d="m6 9 6 6 6-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
              </svg>
            </div>
            
            <div class="hidden sm:block w-px h-10 bg-white/30 mx-4"></div>
            
            <!-- Search Button (desktop) -->
            <button id="hero-search-desktop" class="hidden sm:inline-flex items-center justify-center bg-white/30 backdrop-blur-md border border-white/30 hover:bg-white/40 rounded-full px-5 md:px-6 py-2.5 md:py-3 h-8 md:h-10 text-white text-sm md:text-base transition-all shadow-lg font-medium">
              <svg class="w-3 h-3 md:w-4 md:h-4 mr-2" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
                <path d="m21 21-4.34-4.34" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none" />
              </svg>
              Search
            </button>
          </div>
        </div>

        <!-- Reviews Section -->
        <div class="flex flex-col items-center justify-center gap-3 mt-2">
          <div class="flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-3">
            <div class="flex items-center gap-3 sm:gap-6">
              <div class="flex -space-x-2 sm:-space-x-3">
                <img src={man1.src || man1.url} srcset={man1.srcset} sizes="96px" alt={man1.alt || 'Happy customer review'} width={man1.width} height={man1.height} class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 aspect-square rounded-full border-4 border-white object-cover shadow-md" loading="lazy" />
                <img src={man2.src || man2.url} srcset={man2.srcset} sizes="96px" alt={man2.alt || 'Happy customer review'} width={man2.width} height={man2.height} class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 aspect-square rounded-full border-4 border-white object-cover shadow-md" loading="lazy" />
                <img src={man3.src || man3.url} srcset={man3.srcset} sizes="96px" alt={man3.alt || 'Happy customer review'} width={man3.width} height={man3.height} class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 aspect-square rounded-full border-4 border-white object-cover shadow-md" loading="lazy" />
                <img src={man4.src || man4.url} srcset={man4.srcset} sizes="96px" alt={man4.alt || 'Happy customer review'} width={man4.width} height={man4.height} class="w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 aspect-square rounded-full border-4 border-white object-cover shadow-md" loading="lazy" />
              </div>
              <div class="flex items-center gap-2 sm:gap-3">
                <span class="font-inter font-semibold text-white text-xl sm:text-2xl md:text-3xl lg:text-4xl leading-none">5/5</span>
                <svg class="text-white w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                  <path d="M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z" fill="currentColor" />
                </svg>
              </div>
            </div>
            <div class="text-center">
              <p class="text-sm sm:text-base md:text-lg font-inter text-white/90">
                from <span class="font-semibold">thousands of online reviews</span>
              </p>
            </div>
          </div>
          
          <!-- Trustpilot Widget -->
          <div class="w-full max-w-md px-4">
            <div class="trustpilot-widget" data-locale="en-GB" data-template-id="5419b6a8b0d04a076446a9ad" data-businessunit-id="5fdb351da3a2b60001ac34ba" data-style-height="24px" data-style-width="100%" data-theme="dark" data-token="ca9d8ad1-cc16-49ab-a0e8-b1baa3dd973b" data-min-review-count="0" data-style-alignment="center">
              <a href="https://uk.trustpilot.com/review/activeaway.com" target="_blank" rel="noopener">Trustpilot</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .font-inter {
    font-family: 'Inter', sans-serif;
  }
  
  .font-playfair {
    font-family: 'Playfair Display', serif;
  }
</style>

<script define:vars={{ eventsSearchData }}>
  // Hero search functionality - cascading dropdowns and search redirect
  
  // DOM elements
  const productMobile = document.getElementById('hero-product-mobile');
  const productDesktop = document.getElementById('hero-product-desktop');
  const locationMobile = document.getElementById('hero-location-mobile');
  const locationDesktop = document.getElementById('hero-location-desktop');
  const monthMobile = document.getElementById('hero-month-mobile');
  const monthDesktop = document.getElementById('hero-month-desktop');
  const searchMobile = document.getElementById('hero-search-mobile');
  const searchDesktop = document.getElementById('hero-search-desktop');
  
  // Helper function to populate select options
  function populateSelect(selectElement, options, placeholder) {
    if (!selectElement) return;
    
    // Clear existing options except placeholder
    selectElement.innerHTML = `<option value="" class="text-gray-800 bg-white px-4">${placeholder}</option>`;
    
    // Add new options
    options.forEach(option => {
      const optionElement = document.createElement('option');
      optionElement.value = option;
      optionElement.textContent = option;
      optionElement.className = 'text-gray-800 bg-white px-4';
      selectElement.appendChild(optionElement);
    });
  }
  
  // Helper function to enable/disable select
  function setSelectEnabled(selectElement, enabled) {
    if (!selectElement) return;
    
    if (enabled) {
      selectElement.removeAttribute('disabled');
    } else {
      selectElement.setAttribute('disabled', 'disabled');
      selectElement.value = '';
    }
  }
  
  // Handle product selection (both mobile and desktop)
  function handleProductChange(selectedProduct) {
    console.log('üîç Product selected:', selectedProduct);
    
    if (!selectedProduct) {
      // Product deselected - disable and reset location and month
      setSelectEnabled(locationMobile, false);
      setSelectEnabled(locationDesktop, false);
      setSelectEnabled(monthMobile, false);
      setSelectEnabled(monthDesktop, false);
      return;
    }
    
    // Filter events by selected product
    const filteredEvents = eventsSearchData.allEvents.filter(e => e.product === selectedProduct);
    
    // Extract unique venues from filtered events
    const venues = [...new Set(filteredEvents.map(e => e.venue_plain_text).filter(Boolean))].sort();
    
    console.log(`üìç Found ${venues.length} venues for product: ${selectedProduct}`);
    
    // Populate location dropdowns
    populateSelect(locationMobile, venues, 'Location');
    populateSelect(locationDesktop, venues, 'Select Location');
    
    // Enable location dropdowns
    setSelectEnabled(locationMobile, true);
    setSelectEnabled(locationDesktop, true);
    
    // Disable and reset month dropdowns (location not selected yet)
    setSelectEnabled(monthMobile, false);
    setSelectEnabled(monthDesktop, false);
  }
  
  // Handle location selection (both mobile and desktop)
  function handleLocationChange(selectedProduct, selectedLocation) {
    console.log('üîç Location selected:', selectedLocation);
    
    if (!selectedLocation) {
      // Location deselected - disable and reset month
      setSelectEnabled(monthMobile, false);
      setSelectEnabled(monthDesktop, false);
      return;
    }
    
    // Filter events by selected product AND location
    const filteredEvents = eventsSearchData.allEvents.filter(e => 
      e.product === selectedProduct && e.venue_plain_text === selectedLocation
    );
    
    // Extract unique months from filtered events
    const monthsSet = new Set();
    filteredEvents.forEach(e => {
      if (e.dateFrom) {
        const date = new Date(e.dateFrom);
        const monthName = date.toLocaleDateString('en-US', { month: 'long' });
        monthsSet.add(monthName);
      }
    });
    
    const months = Array.from(monthsSet).sort((a, b) => {
      const monthOrder = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
      return monthOrder.indexOf(a) - monthOrder.indexOf(b);
    });
    
    console.log(`üìÖ Found ${months.length} months for product: ${selectedProduct}, venue: ${selectedLocation}`);
    
    // Populate month dropdowns
    populateSelect(monthMobile, months, 'Month');
    populateSelect(monthDesktop, months, 'Select Month');
    
    // Enable month dropdowns
    setSelectEnabled(monthMobile, true);
    setSelectEnabled(monthDesktop, true);
  }
  
  // Sync mobile and desktop product dropdowns
  productMobile?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (productDesktop) productDesktop.value = value;
    handleProductChange(value);
  });
  
  productDesktop?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (productMobile) productMobile.value = value;
    handleProductChange(value);
  });
  
  // Sync mobile and desktop location dropdowns
  locationMobile?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (locationDesktop) locationDesktop.value = value;
    const selectedProduct = productMobile?.value || productDesktop?.value;
    handleLocationChange(selectedProduct, value);
  });
  
  locationDesktop?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (locationMobile) locationMobile.value = value;
    const selectedProduct = productMobile?.value || productDesktop?.value;
    handleLocationChange(selectedProduct, value);
  });
  
  // Sync mobile and desktop month dropdowns
  monthMobile?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (monthDesktop) monthDesktop.value = value;
  });
  
  monthDesktop?.addEventListener('change', (e) => {
    const value = e.target.value;
    if (monthMobile) monthMobile.value = value;
  });
  
  // Handle search button clicks
  function handleSearch() {
    const product = productMobile?.value || productDesktop?.value;
    const location = locationMobile?.value || locationDesktop?.value;
    const month = monthMobile?.value || monthDesktop?.value;
    
    console.log('üîç Search clicked:', { product, location, month });
    
    // Build URL parameters
    const params = new URLSearchParams();
    
    if (product) {
      params.set('products', product);
    }
    
    if (location) {
      params.set('venues', location);
    }
    
    if (month) {
      params.set('month', month);
    }
    
    // Redirect to events page with parameters
    const url = params.toString() ? `/events?${params}` : '/events';
    console.log('üîó Redirecting to:', url);
    window.location.href = url;
  }
  
  searchMobile?.addEventListener('click', handleSearch);
  searchDesktop?.addEventListener('click', handleSearch);
  
  console.log('‚úÖ Hero search initialized');
</script>
