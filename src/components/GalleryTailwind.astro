---
// Gallery data - TODO: Replace with API data - Tailwind CSS Version
import { getImageByName, getResponsiveImageByName } from '../utils/cloudflareImages.js';

const GALLERY_IMAGE_SIZES = '(max-width: 640px) 60vw, (max-width: 1024px) 25vw, 20vw';

const buildGalleryImage = (imageName, alt) => {
  const attrs = getResponsiveImageByName(imageName, {
    displayWidth: 400,
    displayHeight: 320,
    fit: 'cover',
    alt,
    sizes: GALLERY_IMAGE_SIZES
  });

  if (attrs) {
    return attrs;
  }

  const fallbackSrc = getImageByName(imageName, { width: 400, height: 320, fit: 'cover', format: 'auto', quality: 85 });
  return {
    src: fallbackSrc,
    url: fallbackSrc,
    width: 400,
    height: 320,
    alt,
    loading: 'lazy',
    sizes: GALLERY_IMAGE_SIZES
  };
};

const gallery1Image = buildGalleryImage('gallery-1', 'Active Away gallery image 1');
const gallery2Image = buildGalleryImage('gallery-2', 'Active Away gallery image 2');
const gallery3Image = buildGalleryImage('gallery-3', 'Active Away gallery image 3');
const gallery4Image = buildGalleryImage('gallery-4', 'Active Away gallery image 4');
const gallery5Image = buildGalleryImage('gallery-5', 'Active Away gallery image 5');

const instagramIcon = getResponsiveImageByName('instagram-icon', {
  displayWidth: 32,
  displayHeight: 32,
  fit: 'contain',
  alt: 'Instagram',
  sizes: '32px'
}) ?? (() => {
  const fallbackSrc = getImageByName('instagram-icon', { width: 32, height: 32, fit: 'contain', format: 'auto', quality: 85 });
  return { src: fallbackSrc, url: fallbackSrc, width: 32, height: 32, alt: 'Instagram', loading: 'lazy', sizes: '32px' };
})();

const galleryData = {
  images: [
    {
      id: 1,
      image: gallery4Image, // w=320 (15).png
      background: "#AD986C"
    },
    {
      id: 2,
      image: gallery5Image, // w=320 (16).png
      background: "#1E1E1E"
    },
    {
      id: 3,
      image: gallery1Image, // w=300 (13).png
      background: "#AD986C"
    },
    {
      id: 4,
      image: gallery3Image, // w=320 (14).png
      background: "#1E1E1E"
    },
    {
      id: 5,
      image: gallery2Image, // w=300 (8).png
      background: "#AD986C"
    }
  ],
  instagramIcon: instagramIcon // instagram-stroke-rounded.png
};

// Debug: Log the URLs being generated
console.log('Gallery Images URLs:', { 
  gallery1Image: gallery1Image.url || gallery1Image.src,
  gallery2Image: gallery2Image.url || gallery2Image.src,
  gallery3Image: gallery3Image.url || gallery3Image.src,
  gallery4Image: gallery4Image.url || gallery4Image.src,
  gallery5Image: gallery5Image.url || gallery5Image.src,
  instagramIcon: instagramIcon.url || instagramIcon.src 
});
---

<section class="w-full bg-gray-50 py-12 sm:py-16">
  <!-- Gallery Images -->
  <div class="flex flex-row">
    {galleryData.images.map((item) => (
      <div class="gallery-item flex-1 h-48 sm:h-64 lg:h-72 relative overflow-hidden" style={`background: ${item.background}`}>
        <img 
          src={item.image.src || item.image.url} 
          {...(item.image.srcset && { srcset: item.image.srcset })}
          sizes={item.image.sizes || GALLERY_IMAGE_SIZES}
          width={item.image.width || 400}
          height={item.image.height || 320}
          alt={item.image.alt || `Gallery image ${item.id}`}
          loading={item.image.loading || 'lazy'}
          class="w-full h-full object-cover hover:scale-105 transition-transform duration-300" 
        />
      </div>
    ))}
  </div>

  <!-- Instagram Follow Section -->
  <div class="w-full bg-gray-50 py-8 sm:py-12">
    <div class="container mx-auto px-4 sm:px-10">
      <div class="flex justify-center items-center">
        <div class="flex items-center gap-3 sm:gap-4">
          <img 
            src={galleryData.instagramIcon.src || galleryData.instagramIcon.url} 
            {...(galleryData.instagramIcon.srcset && { srcset: galleryData.instagramIcon.srcset })}
            sizes={galleryData.instagramIcon.sizes || '32px'}
            width={galleryData.instagramIcon.width || 32}
            height={galleryData.instagramIcon.height || 32}
            alt={galleryData.instagramIcon.alt || 'Instagram'} 
            loading={galleryData.instagramIcon.loading || 'lazy'}
            class="w-6 h-6 sm:w-8 sm:h-8" 
          />
          <span class="text-lg sm:text-xl font-inter font-normal text-gold text-center">
            Follow @active.away
          </span>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .font-inter {
    font-family: 'Inter', sans-serif;
  }
</style>
