---
// Events section component for Active Away - Tailwind CSS Version
import { getImageByName } from '../utils/cloudflareImages.js';

// Get dynamic image URLs
const event1Image = getImageByName('event-1', { size: 'public' });
const event2Image = getImageByName('event-2', { size: 'public' });
const event3Image = getImageByName('event-3', { size: 'public' });

// TODO: Replace with API call when backend is ready
// Example: const events = await fetch('/api/events').then(res => res.json());

const events = [
  {
    id: 1,
    title: "Adult Tennis Holiday - 5* Sani Beach Hotel",
    location: "United Kingdome",
    type: "Adult Weekend Tennis Clinic",
    date: "Sat 01 - Sun 02 November 2025",
    availability: "N/A",
    price: "£218pp",
    image: event1Image, // w=320 1 (3).png
    active: false
  },
  {
    id: 2,
    title: "Adult Tennis Holiday - 5* Sani Beach Hotel",
    location: "United Kingdome",
    type: "Adult Weekend Tennis Clinic",
    date: "Sat 01 - Sun 02 November 2025",
    availability: "N/A",
    price: "£218pp",
    image: event2Image, // w=320 1 (4).png
    active: true
  },
  {
    id: 3,
    title: "Adult Tennis Holiday - 5* Sani Beach Hotel",
    location: "United Kingdome",
    type: "Adult Weekend Tennis Clinic",
    date: "Sat 01 - Sun 02 November 2025",
    availability: "N/A",
    price: "£218pp",
    image: event3Image, // w=320 1 (5).png
    active: false
  }
];

// Debug: Log the URLs being generated
console.log('Event Images URLs:', { event1Image, event2Image, event3Image });
---

<section class="w-full bg-gray-50 py-12 sm:py-16 lg:py-24 px-6 sm:px-10">
  <div class="container mx-auto">
    <!-- Header -->
    <div class="mb-6 sm:mb-8 lg:mb-16">
      <div class="text-sm sm:text-base font-inter font-medium text-gray-900 tracking-widest uppercase mb-1 sm:mb-2">
        JOIN US
      </div>
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-2 sm:gap-3 lg:gap-4">
        <h2 class="text-2xl sm:text-3xl lg:text-4xl font-playfair font-semibold text-gray-900">
          Our upcoming events
        </h2>
        <a href="#" class="text-base sm:text-lg font-inter text-gray-900 underline hover:text-gray-700 transition-colors">
          View All Events
        </a>
      </div>
    </div>

    <!-- Events Carousel -->
    <div class="relative">
      <!-- Navigation Arrows -->
      <button class="hidden lg:flex absolute left-4 top-1/2 transform -translate-y-1/2 z-10 w-12 h-12 bg-white rounded-full shadow-lg items-center justify-center hover:bg-gray-50 transition-all duration-300" onclick="previousEvent()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M15 18L9 12L15 6" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <button class="hidden lg:flex absolute right-4 top-1/2 transform -translate-y-1/2 z-10 w-12 h-12 bg-white rounded-full shadow-lg items-center justify-center hover:bg-gray-50 transition-all duration-300" onclick="nextEvent()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M9 18L15 12L9 6" stroke="#1E1E1E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>

      <!-- Events Container -->
      <div class="flex flex-col lg:flex-row justify-center items-center gap-4 sm:gap-6 lg:gap-8">
        {events.map((event) => (
          <div class={`event-card w-full max-w-sm sm:max-w-md lg:max-w-lg ${event.active ? 'active' : 'inactive'}`}>
            <div class="relative overflow-hidden rounded-2xl bg-gray-900">
              <img src={event.image} alt={event.title} class="w-full h-48 sm:h-56 lg:h-64 object-cover" />
            </div>
            
            <div class="relative -mt-8 lg:-mt-12 z-10 px-4 sm:px-6">
              <div class="bg-white border border-gray-200 rounded-2xl p-4 sm:p-6 shadow-lg">
                <h3 class="text-lg sm:text-xl lg:text-2xl font-playfair font-bold text-gray-900 mb-3 sm:mb-4">
                  {event.title}
                </h3>
                
                <div class="space-y-2 sm:space-y-3 mb-4 sm:mb-6">
                  <div class="flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-600 flex-shrink-0" viewBox="0 0 18 18" fill="none">
                      <path d="M9 16.5C13.1421 16.5 16.5 13.1421 16.5 9C16.5 4.85786 13.1421 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 13.1421 4.85786 16.5 9 16.5Z" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M9 5.25V9L12 10.5" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-sm sm:text-base font-inter text-gray-700">{event.location}</span>
                  </div>
                  
                  <div class="flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-600 flex-shrink-0" viewBox="0 0 18 18" fill="none">
                      <path d="M15 3H3C2.17157 3 1.5 3.67157 1.5 4.5V15C1.5 15.8284 2.17157 16.5 3 16.5H15C15.8284 16.5 16.5 15.8284 16.5 15V4.5C16.5 3.67157 15.8284 3 15 3Z" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M6 1.5V4.5" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M12 1.5V4.5" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-sm sm:text-base font-inter text-gray-700">{event.date}</span>
                  </div>
                  
                  <div class="flex items-center gap-3">
                    <svg class="w-5 h-5 text-gray-600 flex-shrink-0" viewBox="0 0 18 18" fill="none">
                      <path d="M9 1.5C13.1421 1.5 16.5 4.85786 16.5 9C16.5 13.1421 13.1421 16.5 9 16.5C4.85786 16.5 1.5 13.1421 1.5 9C1.5 4.85786 4.85786 1.5 9 1.5Z" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M9 5.25V9L12 10.5" stroke="#1E1E1E" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-sm sm:text-base font-inter text-gray-700">{event.type}</span>
                  </div>
                </div>
                
                <div class="flex items-center justify-between">
                  <div class="text-xl sm:text-2xl lg:text-3xl font-inter font-semibold text-gray-900">
                    {event.price}
                  </div>
                  <button class="px-4 sm:px-6 py-2 sm:py-3 bg-gold hover:bg-gold-700 text-white font-inter font-medium text-sm sm:text-base rounded-full transition-all duration-300 hover:-translate-y-0.5">
                    Book Now
                  </button>
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>

    <!-- Pagination Dots -->
    <div class="flex justify-center items-center gap-2 mt-8 sm:mt-12">
      <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
      <div class="w-8 h-2 bg-gold rounded-full"></div>
      <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
      <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
      <div class="w-2 h-2 bg-gray-300 rounded-full"></div>
    </div>
  </div>
</section>

<style>
  .font-inter {
    font-family: 'Inter', sans-serif;
  }
  
  .font-playfair {
    font-family: 'Playfair Display', serif;
  }
  
  /* Active/Inactive card states */
  .event-card.active {
    transform: scale(1.05);
    z-index: 10;
  }
  
  .event-card.inactive {
    opacity: 0.7;
    transform: scale(0.95);
  }
  
  /* Smooth transitions */
  .event-card {
    transition: all 0.3s ease;
  }
  
  /* Mobile responsive adjustments */
  @media (max-width: 1023px) {
    .event-card.active,
    .event-card.inactive {
      transform: none;
      opacity: 1;
    }
  }
</style>

<script>
  // Carousel functionality for future API integration
  let currentActiveIndex = 1; // Index of active card (0-based)
  const totalEvents = 3; // Will be dynamic with API

  function updateCarousel() {
    const cards = document.querySelectorAll('.event-card');
    const dots = document.querySelectorAll('.dot');
    
    cards.forEach((card, index) => {
      card.classList.remove('active', 'inactive');
      if (index === currentActiveIndex) {
        card.classList.add('active');
      } else {
        card.classList.add('inactive');
      }
    });
    
    dots.forEach((dot, index) => {
      dot.classList.remove('active');
      if (index === currentActiveIndex) {
        dot.classList.add('active');
      }
    });
  }

  function nextEvent() {
    currentActiveIndex = (currentActiveIndex + 1) % totalEvents;
    updateCarousel();
  }

  function previousEvent() {
    currentActiveIndex = (currentActiveIndex - 1 + totalEvents) % totalEvents;
    updateCarousel();
  }

  // Initialize carousel on page load
  document.addEventListener('DOMContentLoaded', () => {
    updateCarousel();
  });

  // TODO: When API is integrated, replace with:
  // async function loadEvents() {
  //   const response = await fetch('/api/events');
  //   const data = await response.json();
  //   totalEvents = data.length;
  //   // Update DOM with API data
  // }
</script>
